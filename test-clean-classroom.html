<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Clean Classroom</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 16px;
        }
        .test-btn:hover {
            background: #45a049;
        }
        .test-btn.teacher {
            background: #2196F3;
        }
        .test-btn.teacher:hover {
            background: #1976D2;
        }
        .test-btn.student {
            background: #FF9800;
        }
        .test-btn.student:hover {
            background: #F57C00;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .test-room {
            background: #e9ecef;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Test Clean Classroom Version</h1>
    
    <div class="test-section">
        <h2>ğŸ“‹ Test Instructions</h2>
        <p>This page helps you test the clean version of the live classroom. Follow these steps:</p>
        <ol>
            <li><strong>Setup:</strong> Make sure your server is running (npm start)</li>
            <li><strong>Test Room:</strong> Use the test room ID below</li>
            <li><strong>Open Two Tabs:</strong> One for teacher, one for student</li>
            <li><strong>Test Features:</strong> Check camera, chat, whiteboard, etc.</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>ğŸ”‘ Test Room Setup</h2>
        <p>Use this test room ID for testing:</p>
        <div class="test-room" id="test-room-id">test-room-20241201</div>
        <button class="test-btn" onclick="copyRoomId()">ğŸ“‹ Copy Room ID</button>
        <button class="test-btn" onclick="generateNewRoom()">ğŸ”„ Generate New Room</button>
    </div>

    <div class="test-section">
        <h2>ğŸ‘¨â€ğŸ« Teacher Test</h2>
        <p>Test the classroom as a teacher:</p>
        <button class="test-btn teacher" onclick="testAsTeacher()">ğŸš€ Open as Teacher</button>
        <div id="teacher-status"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“ Student Test</h2>
        <p>Test the classroom as a student:</p>
        <button class="test-btn student" onclick="testAsStudent()">ğŸš€ Open as Student</button>
        <div id="student-status"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ” Test Checklist</h2>
        <div id="test-checklist">
            <p><input type="checkbox" id="check1"> âœ… Server running</p>
            <p><input type="checkbox" id="check2"> âœ… Teacher page loads</p>
            <p><input type="checkbox" id="check3"> âœ… Student page loads</p>
            <p><input type="checkbox" id="check4"> âœ… Camera permission granted</p>
            <p><input type="checkbox" id="check5"> âœ… Local video shows</p>
            <p><input type="checkbox" id="check6"> âœ… Remote video shows</p>
            <p><input type="checkbox" id="check7"> âœ… Chat works</p>
            <p><input type="checkbox" id="check8"> âœ… Whiteboard works</p>
            <p><input type="checkbox" id="check9"> âœ… Screen sharing works</p>
            <p><input type="checkbox" id="check10"> âœ… Timer works</p>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ› Debug Tools</h2>
        <button class="test-btn" onclick="checkServerStatus()">ğŸ” Check Server Status</button>
        <button class="test-btn" onclick="clearLocalStorage()">ğŸ—‘ï¸ Clear Local Storage</button>
        <button class="test-btn" onclick="openConsole()">ğŸ“ Open Console</button>
        <div id="debug-status"></div>
    </div>

    <script>
        // Generate a test room ID
        function generateRoomId() {
            const now = new Date();
            const dateStr = now.getFullYear().toString() + 
                           (now.getMonth() + 1).toString().padStart(2, '0') + 
                           now.getDate().toString().padStart(2, '0');
            return `test-room-${dateStr}`;
        }

        // Initialize with a test room ID
        document.getElementById('test-room-id').textContent = generateRoomId();

        // Copy room ID to clipboard
        function copyRoomId() {
            const roomId = document.getElementById('test-room-id').textContent;
            navigator.clipboard.writeText(roomId).then(() => {
                showStatus('teacher-status', 'Room ID copied to clipboard!', 'success');
            });
        }

        // Generate new room ID
        function generateNewRoom() {
            const newRoomId = generateRoomId();
            document.getElementById('test-room-id').textContent = newRoomId;
            showStatus('teacher-status', 'New room ID generated!', 'success');
        }

        // Test as teacher
        function testAsTeacher() {
            const roomId = document.getElementById('test-room-id').textContent;
            
            // Set teacher ID in localStorage
            localStorage.setItem('teacherId', 'TKBF7202500001');
            localStorage.setItem('remoedUsername', 'Test Teacher');
            
            // Open clean classroom as teacher
            const url = `live-classroom-clean.html?room=${roomId}`;
            window.open(url, '_blank');
            
            showStatus('teacher-status', 'Teacher classroom opened in new tab!', 'success');
            document.getElementById('check2').checked = true;
        }

        // Test as student
        function testAsStudent() {
            const roomId = document.getElementById('test-room-id').textContent;
            
            // Set student ID in localStorage
            localStorage.setItem('studentId', 'test-student-456');
            localStorage.setItem('remoedUsername', 'Test Student');
            
            // Open clean classroom as student
            const url = `live-classroom-clean.html?room=${roomId}`;
            window.open(url, '_blank');
            
            showStatus('student-status', 'Student classroom opened in new tab!', 'success');
            document.getElementById('check3').checked = true;
        }

        // Check server status
        async function checkServerStatus() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                showStatus('debug-status', `Server is running! Status: ${data.status}`, 'success');
                document.getElementById('check1').checked = true;
            } catch (error) {
                showStatus('debug-status', 'Server is not running. Please start with: npm start', 'error');
            }
        }

        // Clear localStorage
        function clearLocalStorage() {
            localStorage.clear();
            showStatus('debug-status', 'Local storage cleared!', 'info');
        }

        // Open console
        function openConsole() {
            showStatus('debug-status', 'Press F12 to open browser console for debugging', 'info');
        }

        // Show status message
        function showStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => {
                element.innerHTML = '';
            }, 5000);
        }

        // Auto-check server status on page load
        window.addEventListener('load', () => {
            setTimeout(checkServerStatus, 1000);
        });

        // Instructions for testing
        console.log('ğŸ§ª Test Clean Classroom - Instructions:');
        console.log('1. Make sure server is running (npm start)');
        console.log('2. Click "Open as Teacher" to test teacher view');
        console.log('3. Click "Open as Student" to test student view');
        console.log('4. Check that cameras work on both ends');
        console.log('5. Test chat, whiteboard, and other features');
        console.log('6. Use browser console (F12) for debugging');
    </script>
</body>
</html>
